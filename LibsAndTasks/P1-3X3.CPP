/* 256Color Vga Graphics + Persian font addon.
   This program is generated by Amin Safinejad,
   available on http://Tetta.5u.com (my Website!)
   Mailto: Amin1986@gmail.com

   Selected persian fonts: Sina Bold
			   Titr Bold
			   Bulb
	List of all available fonts (taken from Zarnegar76 (C)):
	AVLB.CHR   AVLR.CHR   BBD.CHR    BDRR.CHR   BNFI.CHR   BNKB.CHR   BOLD.CHR
	BRDB.CHR   BRDR.CHR   BRG.CHR    BRSX.CHR   BT1R.CHR   BT2R.CHR   BT3R.CHR
	C.CHR      COMB.CHR   COMR.CHR   COPB.CHR   CPTB.CHR   CPUR.CHR   CRCB.CHR
	CRCR.CHR   CRNR.CHR   CTGR.CHR   DAPR.CHR   DCLB.CHR   EURO.CHR   FUTI.CHR
	GEOR.CHR   GHRB.CHR   GOTH.CHR   HERR.CHR   HLVB.CHR   HLVX.CHR   HMMB.CHR
	HOLR.CHR   HOMB.CHR   HOUR.CHR   IRLR.CHR   JADH.CHR   KDKB.CHR   KEYR.CHR
	KLAB.CHR   KLAR.CHR   KMM.CHR    KMN.CHR    KRMB.CHR   LCOM.CHR   LITT.CHR
	LNSR.CHR   LTKB.CHR   LTKR.CHR   MHRB.CHR   MODH.CHR   MOTB.CHR   PDSR.CHR
	PHTR.CHR   PLGR.CHR   PNGB.CHR   PRSB.CHR   PRSR.CHR   RFWR.CHR   ROYB.CHR
	ROYR.CHR   SANS.CHR   SCRI.CHR   SHLR.CHR   SIMP.CHR   SINB.CHR   TAMB.CHR
	TCHR.CHR   TITB.CHR   TMPB.CHR   TMSB.CHR   TMSR.CHR   TMSX.CHR   TRFB.CHR
	TRFH.CHR   TRFR.CHR   TRIP.CHR   TSCR.CHR   TYPB.CHR   WDGR.CHR   YAGR.CHR
	YASB.CHR   YASR.CHR   YSMB.CHR   ZAKR.CHR   ZARB.CHR   ZARJ.CHR   ZURR.CHR

	titrnew = titb
	sina    = sinb
	prince  = plgr

	bulb    = CTGR
	titr    = yasb
	homanew = homb
	homa    = brdb
	trafic  = trfh
	italic  = klab
	straight= motb
	tehran  = yasr
	jadid   = jadh
	fantasy = lnsr
	roya    = royr
	kids    = tchr
	arial   = avlr
	kamran  = brdr
	modern  = crnr

	clara   = klar
	titrnew = titb
	traffic2= trfr
	tehran  = yasr
	electral= pngb
	boldest = tmpb
	fantait = brsx
	jadid   = jadh
	straight= motb
	zar     = zarb

	...No rights reserved!... */

#include <string.h>
#include <ctype.h>
#include <iostream.h>
#include <stdio.h>
#include <stdlib.h>
#include <dos.h>
#include <conio.h>
#include <graphics.h>
#include <math.h>
#include <process.h>

void flashcolor(int c,int r,int g,int b);
void unflashcolor(int c,int r,int g,int b);

struct array3x3 {int i1[4][4];};
struct array3x3float {long float i1[4][4];};
const char availables[30]="ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      char availnum[13]  ="1234567890-";
int availablenum (char c){
int y=0;
for (int i=0;i<=11;i++){
if (c==availnum[i]) {y=1;break;}
}
return y;
}

int getgnum(int x,int y,int cl){
struct  time t;
char c=0;
char s[10]="",s1[1];
settextjustify (0,2);
settextstyle (1,0,2);
setcolor (cl);
outtextxy (x,y,s);
do {
gettime(&t);
//t.ti_min, t.ti_hour, t.ti_hund, t.ti_sec
if (((t.ti_hund/25)%2)==0) setcolor(0); else setcolor(15);
outtextxy (x+(textwidth(s)/1.1)+(textwidth(s)/10),y,"_");
if (kbhit()) {
setcolor (0);
outtextxy (x,y,s);
outtextxy (x+textwidth(s)/1.1+(textwidth(s)/10),y,"_");
c=getch();
while (kbhit()){getch();}
s1[1]=0;
s1[0]=0;
s1[0]=c;
if (c==8) s[strlen(s)-1]=0;
if ((c!=8)&&(availablenum(c))) if (strlen(s)<4) strcat(s,s1);
while (kbhit()){getch();}
setcolor (cl);
outtextxy (x,y,s);
}

} while (c!=13 && c!=27);

return atoi(s);
}
void main(void)
{
   int adet=0;
   array3x3 myarray,astar,unastar;
   array3x3float arev;
   char mystr2[20]="";
   char c1;
   int driver,mode=2,font[10];
   int huge install(void);
   long double i,j;
   int temp1;
   driver=installuserdriver ("svga256", install);
   initgraph(&driver, &mode, "e:\\compiler\\borlan~1.1la\\borlan~1\\bgi"); // Where is your Graphic driver?
					 // driver is: Svga256.bgi

   if (graphresult() != grOk) { //  ---> if graph was not inisialized
      printf("\n\rGraphics error! check your Bgi files!");
      printf("\n\rFile: Svga256.bgi needed!");
      printf("\n\n\rPress any key to Exit...");
      getch();
      exit(1);} // ---> Exit program!

   setrgbpalette (0,0,0,10);
   delay(1000);
   setcolor(15);
   setfillstyle (1,1);
   setcolor(240);
   rectangle (22,22,getmaxx()-(22),getmaxy()-22);
   for (i=1;i<=20;i++){
   itoa (i,mystr2,3);
   setcolor (220+i);
   rectangle (20-i,20-i,getmaxx()-(20-i),getmaxy()-(20-i));
   setrgbpalette (220+i,0,63-((i/20)*63),((i/20)*63));
    delay(50);
    }
   setviewport (23,23,getmaxx()-23,getmaxy()-23,1);
      for (i=1;i<=200;i++){
   setrgbpalette(20+i,(i/200)*63,0,63-((i/200)*63));
   }
for (i=16;i<=200;i++) setrgbpalette (i,0,0,10);
   font[3]=installuserfont("crnr");
   font[2]=installuserfont("titb");
   font[1]=installuserfont("sinb");
   settextstyle (font[1],0,1);
   settextjustify(1,2);
   setcolor (100);
   outtextxy ((getmaxx()/2)-20,(getmaxy()/2)-120,"t±žŽ« u½oUB« ³LwBd« ³«B¯oM");
   settextstyle (font[2],0,3);
   setcolor(101);
   outtextxy ((getmaxx()/2)-20,(getmaxy()/2)-70,"pA ºnBŸ");
   outtextxy ((getmaxx()/2)-20,(getmaxy()/2)-35,"jAs¯»– ­¼«A");

   settextstyle (font[3],0,1);
   setcolor(102);
   outtextxy ((getmaxx()/2)-20,(getmaxy())-100,"http://Tetta.5u.com");
   flashcolor(100,63,0,10);
   flashcolor(101,0,63,63);
   flashcolor(102,63,63,10);
   getch();
   unflashcolor(101,0,63,63);
   unflashcolor(100,63,0,10);
   setviewport (23,23,getmaxx()-23,(getmaxy()-55),1);
   clearviewport();
settextstyle (2,1,4);
setcolor(101);
setlinestyle(DOTTED_LINE, 0, 2);
outtextxy(392,50,"'A' Matrix");
line (410        ,  20     , 400        ,  20    );
line (410        , 140     , 400        , 140    );
line (400        ,  20     , 400        , 140    );
line (620-40     ,  20     , 620-40     , 140    );
line (610-40     ,  20     , 620-40     ,  20    );
line (610-40     , 140     , 620-40     , 140    );
setcolor(106);
outtextxy(392,50+140,"'A*' matrix");
line (410        ,  20+140 , 400        ,  20+140);
line (410        , 140+140 , 400        , 140+140);
line (400        ,  20+140 , 400        , 140+140);
line (620-40     ,  20+140 , 620-40     , 140+140);
line (610-40     ,  20+140 , 620-40     ,  20+140);
line (610-40     , 140+140 , 620-40     , 140+140);

outtextxy(392-200,50+120,"Reverse Matrix");
line (410   -200 ,  20+140 , 400   -200 ,  20+140);
line (410   -200 , 140+140 , 400   -200 , 140+140);
line (400   -200 ,  20+140 , 400   -200 , 140+140);
line (620-40-200 ,  20+140 , 620-40-200 , 140+140);
line (610-40-200 ,  20+140 , 620-40-200 ,  20+140);
line (610-40-200 , 140+140 , 620-40-200 , 140+140);

/*

x:=460;
y:=27;
setcolor(9);
settextjustify(2,1);
for n1:=1 to 3 do begin
for m1:=1 to 3 do begin
setcolor(7);
if n1<i[1] then setcolor(9);
if (n1=i[1]) and (m1<i[2]) then setcolor(9);
if (m1=i[2]) and (n1=i[1]) then setcolor(11);
outtextxy(x,y,stri(m[m1,n1]));
x:=x+79;
end;
x:=460;
y:=y+50;
end;
x:=460+(2*79);
y:=17+(3*50);
for m1:=1 to 3 do begin
setcolor(7);
if m1<i[4] then setcolor(9);
if m1=i[4] then setcolor(11);
outtextxy(x,y,stri(n[m1]));
y:=y+50;
end;
settextjustify(0,2);
end;

*/

   settextstyle (4,0,3);
   setcolor (101);
   outtextxy(107,7,"Enter Matrix values:");
   flashcolor(101,63,0,10);
   setcolor(105);
   setrgbpalette(105,63,0,10);
   outtextxy(107,7,"Enter Matrix values:");
   setrgbpalette (11,0,63,63);
   int x1=10,y1=40;
   int myx1=410,myy1=-30;
   char tempstr[6];
   settextjustify (0,2);

   for (int ii1=1,y3=0;ii1<=3;ii1++) {
   for (int jj1=1;jj1<=3;jj1++) {
   if (jj1==1) {myx1=410;myy1+=50;}
   setcolor(120);
   settextstyle (2,0,5);
   outtextxy(myx1,myy1,"0");
   myx1+=60;
   y3+=30; }}
   myx1=410,myy1=-30;
   flashcolor(120,0,0,40);
   for (int ii=1;ii<=3;ii++) {
   for (int jj=1;jj<=3;jj++) {
   if (jj==1) {myx1=410;myy1+=50;}
   setcolor(15);
   settextstyle (2,0,5);
   outtextxy(myx1,myy1,"0");
   myarray.i1[ii][jj]=getgnum (x1,y1,11);
   settextstyle (2,0,5);
   setcolor(0);
   outtextxy(myx1,myy1,"0");
   itoa(myarray.i1[ii][jj],tempstr,10);
   setcolor(9);
   outtextxy(myx1,myy1,tempstr);
   myx1+=60;
   y1+=30; }}

adet = /****/ ((myarray.i1[1][1]*myarray.i1[2][2]*myarray.i1[3][3])+
	       (myarray.i1[2][1]*myarray.i1[3][2]*myarray.i1[1][3])+
	       (myarray.i1[3][1]*myarray.i1[1][2]*myarray.i1[2][3]));

adet = adet - ((myarray.i1[1][1]*myarray.i1[3][2]*myarray.i1[2][3])+
	       (myarray.i1[2][1]*myarray.i1[1][2]*myarray.i1[3][3])+
	       (myarray.i1[3][1]*myarray.i1[2][2]*myarray.i1[1][3]));

char deter[6];
itoa(adet,deter,10);
setcolor(100);
settextjustify(1,2);
settextstyle (7,0,1);
outtextxy (280,getmaxy()-440,"Determinan is:");
settextstyle (7,0,3);
setcolor(104);
outtextxy (280,getmaxy()-420,deter);
flashcolor  (100,63,63,10);
flashcolor  (104, 0,63,10);
unflashcolor(105,63, 0,10);
unflashcolor( 11, 0,63,63);
if (adet!=0) {
flashcolor(106,63,0,10);
unastar.i1[1][1]=  (myarray.i1[2][2]*myarray.i1[3][3])-(myarray.i1[2][3]*myarray.i1[3][2])  ;
unastar.i1[1][2]=-((myarray.i1[2][1]*myarray.i1[3][3])-(myarray.i1[2][3]*myarray.i1[3][1])) ;
unastar.i1[1][3]=  (myarray.i1[2][1]*myarray.i1[3][2])-(myarray.i1[2][2]*myarray.i1[3][1])  ;
unastar.i1[2][1]=-((myarray.i1[1][2]*myarray.i1[3][3])-(myarray.i1[1][3]*myarray.i1[3][2])) ;
unastar.i1[2][2]=  (myarray.i1[1][1]*myarray.i1[3][3])-(myarray.i1[1][3]*myarray.i1[3][1])  ;
unastar.i1[2][3]=-((myarray.i1[1][1]*myarray.i1[3][2])-(myarray.i1[1][2]*myarray.i1[3][1])) ;
unastar.i1[3][1]=  (myarray.i1[1][2]*myarray.i1[2][3])-(myarray.i1[1][3]*myarray.i1[2][2])  ;
unastar.i1[3][2]=-((myarray.i1[1][1]*myarray.i1[2][3])-(myarray.i1[1][3]*myarray.i1[2][1])) ;
unastar.i1[3][3]=  (myarray.i1[1][1]*myarray.i1[2][2])-(myarray.i1[1][2]*myarray.i1[2][1])  ;
     for(int iq=1,myq;iq<=3;iq++)
	for(int jq=1;jq<=3;jq++){
	    myq=unastar.i1[iq][jq];
	    astar.i1[jq][iq]=myq;}

     for (int i_=1,w;i_<=3;i_++) {
	for (int j_=1;j_<=3;j_++) {
	    textcolor(i_);
	    arev.i1[i_][j_]=((1.0/ float(adet))*(float(astar.i1[i_][j_])));  }}

   myx1=410,myy1=110;
   settextjustify(0,2);
   for (int iz=1;iz<=3;iz++) {
   for (int jz=1;jz<=3;jz++) {
   if (jz==1) {myx1=410;myy1+=50;}
   setcolor(15);
   settextstyle (2,0,5);
   itoa(astar.i1[iz][jz],tempstr,10);
   setcolor(119);
   outtextxy(myx1,myy1,tempstr);
   myx1+=60;
   y1+=30; }}

   myx1=210,myy1=110;
   settextjustify(0,2);
   for (int iw=1;iw<=3;iw++) {
   for (int jw=1;jw<=3;jw++) {
   if (jw==1) {myx1=210;myy1+=50;}
   setcolor(15);
   settextstyle (2,0,5);
   ltoa(arev.i1[iw][jw],tempstr,10);
   setcolor(119);
   outtextxy(myx1,myy1,tempstr);
   myx1+=60;
   y1+=30; }}
flashcolor(119,0,0,63);
} else {
setcolor(107);
outtextxy(getmaxx()/2,(getmaxy()/2)+50,"Can't Creat reverse matrix!");
flashcolor(107,63,63,63);
}
settextstyle (2,0,5);
settextjustify(1,2);
setcolor (121);
outtextxy(getmaxx()/2,380,"Hit any key to Exit graphic mode...");
flashcolor (121,63,0,40);
   getch();
unflashcolor(121,63,0,40);
int ax=getmaxx()/2,ay=getmaxy()/2;
setviewport (0,0,getmaxx(),getmaxy(),1);
setlinestyle(0, 0, 2);
while ((ax>0) || (ay>0)) {
setcolor (10);
rectangle (ax,ay,getmaxx()-ax,getmaxy()-ay);
delay (10);
setcolor (0);
rectangle (ax,ay,getmaxx()-ax,getmaxy()-ay);
ax-=1;ay-=1;
}
   closegraph();
if (adet!=0){
textcolor (11);
cprintf ("\n\rNow Here you are the float reverse matrix:\n\r");
textcolor (12);
cprintf ("Ú");
textcolor (11);
for (int zo=1;zo<=3;zo++) {for (int xo=1;xo<=3;xo++) {
textcolor (9);
cprintf ("%8.3f ",arev.i1[zo][xo]);
}
textcolor (12);
if (zo==1) cprintf ("¿"); else if (zo==2) cprintf ("³"); else if (zo==3) cprintf ("Ù");
cprintf ("\n\r");
if (zo==1) cprintf ("³"); else if (zo==2) cprintf ("À");
}
textcolor (13);
cprintf ("\n\rAnd then Hit any key to exit program...");
getch();
cprintf ("\n\n\r");
}
clrscr;
} // Have fun!

int huge install(void)   // Temporary function for installuserdriver.
{
return 0;
}
void flashcolor(int c,int r,int g,int b){
int i,j,r1=0,g1=0,b1=10;
if (b<10) b=10;
while (r1<63 || g1<63 || b1<63) {
if (r1<63) r1++;
if (g1<63) g1++;
if (b1<63) b1++;
setrgbpalette (c,r1,g1,b1);
delay(2);}
r1=63;g1=63;b1=63;
while (r1>r || g1>g || b1>b) {
if (r1>r) r1--;
if (g1>g) g1--;
if (b1>b) b1--;
setrgbpalette (c,r1,g1,b1);
delay(5);}}
void unflashcolor(int c,int r,int g,int b){
if (b<10) b=10;
int i,j,r1=r,g1=g,b1=b;
while (r1<63 || g1<63 || b1<63) {
if (r1<63) r1++;
if (g1<63) g1++;
if (b1<63) b1++;
setrgbpalette (c,r1,g1,b1);
delay(2);}
r1=63;g1=63;b1=63;
while (r1>0 || g1>0 || b1>10) {
if (r1>0) r1--;
if (g1>0) g1--;
if (b1>10) b1--;
setrgbpalette (c,r1,g1,b1);
delay(5);}}