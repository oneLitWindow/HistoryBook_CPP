/* 256Color Vga Graphics + Persian font addon.
   This program is generated by Amin Safinejad,
   available on http://Tetta.5u.com (my Website!)
   Mailto: Amin1986@gmail.com

   Selected persian fonts: Sina Bold
			   Titr Bold
			   Bulb
	List of all available fonts (taken from Zarnegar76 (C)):
	AVLB.CHR   AVLR.CHR   BBD.CHR    BDRR.CHR   BNFI.CHR   BNKB.CHR   BOLD.CHR
	BRDB.CHR   BRDR.CHR   BRG.CHR    BRSX.CHR   BT1R.CHR   BT2R.CHR   BT3R.CHR
	C.CHR      COMB.CHR   COMR.CHR   COPB.CHR   CPTB.CHR   CPUR.CHR   CRCB.CHR
	CRCR.CHR   CRNR.CHR   CTGR.CHR   DAPR.CHR   DCLB.CHR   EURO.CHR   FUTI.CHR
	GEOR.CHR   GHRB.CHR   GOTH.CHR   HERR.CHR   HLVB.CHR   HLVX.CHR   HMMB.CHR
	HOLR.CHR   HOMB.CHR   HOUR.CHR   IRLR.CHR   JADH.CHR   KDKB.CHR   KEYR.CHR
	KLAB.CHR   KLAR.CHR   KMM.CHR    KMN.CHR    KRMB.CHR   LCOM.CHR   LITT.CHR
	LNSR.CHR   LTKB.CHR   LTKR.CHR   MHRB.CHR   MODH.CHR   MOTB.CHR   PDSR.CHR
	PHTR.CHR   PLGR.CHR   PNGB.CHR   PRSB.CHR   PRSR.CHR   RFWR.CHR   ROYB.CHR
	ROYR.CHR   SANS.CHR   SCRI.CHR   SHLR.CHR   SIMP.CHR   SINB.CHR   TAMB.CHR
	TCHR.CHR   TITB.CHR   TMPB.CHR   TMSB.CHR   TMSR.CHR   TMSX.CHR   TRFB.CHR
	TRFH.CHR   TRFR.CHR   TRIP.CHR   TSCR.CHR   TYPB.CHR   WDGR.CHR   YAGR.CHR
	YASB.CHR   YASR.CHR   YSMB.CHR   ZAKR.CHR   ZARB.CHR   ZARJ.CHR   ZURR.CHR

	titrnew = titb
	sina    = sinb
	prince  = plgr

	bulb    = CTGR
	titr    = yasb
	homanew = homb
	homa    = brdb
	trafic  = trfh
	italic  = klab
	straight= motb
	tehran  = yasr
	jadid   = jadh
	fantasy = lnsr
	roya    = royr
	kids    = tchr
	arial   = avlr
	kamran  = brdr
	modern  = crnr

	clara   = klar
	titrnew = titb
	traffic2= trfr
	tehran  = yasr
	electral= pngb
	boldest = tmpb
	fantait = brsx
	jadid   = jadh
	straight= motb
	zar     = zarb

	...No rights reserved!... */

#include <string.h>
#include <ctype.h>
#include <iostream.h>
#include <stdio.h>
#include <stdlib.h>
#include <dos.h>
#include <conio.h>
#include <graphics.h>
#include <math.h>
#include <process.h>

void flashcolor(int c,int r,int g,int b);
void unflashcolor(int c,int r,int g,int b);

const char availables[30]="ABCDEFGHIJKLMNOPQRSTUVWXYZ";
      char availnum[13]  ="1234567890";

unsigned int advancedfactoriel (int i,int kaf) {
unsigned int j=1;
if (kaf<2) kaf=2;
int a;
for (a=i;a>=kaf;a--) {
j*=a;}
cprintf ("Factoriel %d , kaf %d == %i \n\r",i,kaf,j);
return j;
}
int max(int i,int j){
if (j>i) return j;
return i;
}
int availablenum (char c){
int y=0;
for (int i=0;i<=11;i++){
if (c==availnum[i]) {y=1;break;}
}
return y;
}

long getgnum(int x,int y,int cl){
struct time t;
char c=0;
char s[10]="",s1[1];
settextjustify (0,2);
settextstyle (1,0,2);
setcolor (cl);
outtextxy (x,y,s);
do {
gettime(&t);
//t.ti_min, t.ti_hour, t.ti_hund, t.ti_sec
if (((t.ti_hund/25)%2)==0) setcolor(0); else setcolor(15);
outtextxy (x+(textwidth(s)/1.1)+(textwidth(s)/10),y,"_");
if (kbhit()) {
setcolor (0);
outtextxy (x,y,s);
outtextxy (x+textwidth(s)/1.1+(textwidth(s)/10),y,"_");
c=getch();
while (kbhit()){getch();}
s1[1]=0;
s1[0]=0;
s1[0]=c;
if (c==8) s[strlen(s)-1]=0;
if ((c!=8)&&(availablenum(c))) if (strlen(s)<2) strcat(s,s1);
while (kbhit()){getch();}
setcolor (cl);
outtextxy (x,y,s);
}

} while (c!=13 && c!=27);
if (atol(s)>30){
setcolor (0);
outtextxy (x,y,s);
strcpy (s,"30");
setcolor(cl);
outtextxy (x,y,s);
}

return atol(s);
}
void main(void)
{
   char c1;
   char mystr2[20]="";
   int driver,mode=2,font[10];
   int huge install(void);
   long double i,j;
   int temp1;
   driver=installuserdriver ("svga256", install);
   initgraph(&driver, &mode, "e:\\compiler\\borlan~1.1la\\borlan~1\\bgi"); // Where is your Graphic driver?
					 // driver is: Svga256.bgi

   if (graphresult() != grOk) { //  ---> if graph was not inisialized
      printf("\n\rGraphics error! check your Bgi files!");
      printf("\n\rFile: Svga256.bgi needed!");
      printf("\n\n\rPress any key to Exit...");
      getch();
      exit(1);} // ---> Exit program!

   setrgbpalette (0,0,0,10);
   delay(2000);
   setcolor(15);
   setfillstyle (1,1);
   setcolor(240);
   rectangle (22,22,getmaxx()-(22),getmaxy()-22);
   for (i=1;i<=20;i++){
   itoa (i,mystr2,3);
   setcolor (220+i);
   rectangle (20-i,20-i,getmaxx()-(20-i),getmaxy()-(20-i));
   setrgbpalette (220+i,((i/20)*63),63-((i/20)*63),63-(i/20)*63);
    delay(50);
    }
   setviewport (23,23,getmaxx()-23,getmaxy()-23,1);
      for (i=1;i<=200;i++){
   setrgbpalette(20+i,(i/200)*63,0,63-((i/200)*63));
   }
for (i=16;i<=200;i++) setrgbpalette (i,0,0,10);
   font[3]=installuserfont("crnr");
   font[2]=installuserfont("titb");
   font[1]=installuserfont("sinb");
   settextstyle (font[1],0,1);
   settextjustify(1,2);
   setcolor (100);
   outtextxy ((getmaxx()/2)-20,(getmaxy()/2)-120,"¤BžwBQ ¨B¼i W¦X« pA ²A±h§j o…w ³LwBd« ³«B¯oM");
   settextstyle (font[2],0,3);
   setcolor(101);
   outtextxy ((getmaxx()/2)-20,(getmaxy()/2)-70,"pA ºnBŸ");
   outtextxy ((getmaxx()/2)-20,(getmaxy()/2)-35,"jAs¯»– ­¼«A");

   settextstyle (font[3],0,1);
   setcolor(102);
   outtextxy ((getmaxx()/2)-20,(getmaxy())-100,"http://Tetta.5u.com");
   flashcolor(100,63,0,10);
   flashcolor(101,0,63,63);
   flashcolor(102,63,63,10);
   getch();
   unflashcolor(101,0,63,63);
   unflashcolor(100,63,0,10);
   setviewport (23,23,getmaxx()-23,(getmaxy()-55),1);
   clearviewport();
   settextstyle (7,0,1);
   settextjustify (0,2);
   setcolor(100);
   outtextxy (2,10,"Enter your line number (max.30) to calculate:");
   flashcolor (100,63,0,10);
   int x;
   x=getgnum(2,40,9);
//   closegraph();
long k[32][33];
k[0][0]=1;
k[1][0]=1;
k[1][1]=1;
int l;
char c[16],s[280]="1";
for (int t=2;t<=x;t++){
//cprintf ("\n\r 1 ");
k[t][0]=1;
k[t][t]=1;
strcpy(s,"1 ");
for (l=1;l<((t));l++) {k[t][l]=k[t-1][l]+k[t-1][l-1];/*cprintf ("%ld ",k[t][l]);*/ltoa(k[t][l],c,10);strcat(s,c);strcat(s," ");}
strcat(s,"1");
//cprintf ("1");
}
//cprintf ("\n\r %s",s);
settextstyle (2,0,5);
settextjustify(1,2);
setcolor (121);
outtextxy((getmaxx()/2)-27,380,"Press arrow keys to move line, Hit Esc/Enter to Exit program...");
char s2[140];
int xx=2,xo=2;
char c2=0;
settextjustify(0,2);
settextstyle (7,0,2);
setcolor(111);
outtextxy (2,70,"Your requested Line is:");
setcolor(110);
settextstyle (2,0,4);
outtextxy (xx,100,s);
flashcolor (111,63,0,10);
flashcolor (110,0,63,10);
flashcolor (121,63,0,40);
//if (29+textwidth(s)>getmaxx()-29) {
while ((c2!=27) && (c2!=13)){
setcolor(110);
outtextxy (xx,100,s);
c2=getch();
if (c2==75) if (xx+textwidth(s)+27+29>getmaxx()) xx-=10;
if (c2==77) if (xx<2) xx+=10;
if (xo!=xx) {
setcolor(0);
outtextxy (xo,100,s);}
xo=xx;
}//} else getch();
//getch();
unflashcolor(121,63,0,40);
int ax=getmaxx()/2,ay=getmaxy()/2;
setviewport (0,0,getmaxx(),getmaxy(),1);
setlinestyle(0, 0, 2);
while ((ax>0) || (ay>0)) {
setcolor (11);
rectangle (ax,ay,getmaxx()-ax,getmaxy()-ay);
delay (10);
setcolor (0);
rectangle (ax,ay,getmaxx()-ax,getmaxy()-ay);
ax-=1;ay-=1;
}
   closegraph();
   clrscr;
} // Have fun!

int huge install(void)   // Temporary function for installuserdriver.
{
return 0;
}
void flashcolor(int c,int r,int g,int b){
int i,j,r1=0,g1=0,b1=10;
if (b<10) b=10;
while (r1<63 || g1<63 || b1<63) {
if (r1<63) r1++;
if (g1<63) g1++;
if (b1<63) b1++;
setrgbpalette (c,r1,g1,b1);
delay(2);}
r1=63;g1=63;b1=63;
while (r1>r || g1>g || b1>b) {
if (r1>r) r1--;
if (g1>g) g1--;
if (b1>b) b1--;
setrgbpalette (c,r1,g1,b1);
delay(5);}}
void unflashcolor(int c,int r,int g,int b){
if (b<10) b=10;
int i,j,r1=r,g1=g,b1=b;
while (r1<63 || g1<63 || b1<63) {
if (r1<63) r1++;
if (g1<63) g1++;
if (b1<63) b1++;
setrgbpalette (c,r1,g1,b1);
delay(2);}
r1=63;g1=63;b1=63;
while (r1>0 || g1>0 || b1>10) {
if (r1> 0) r1--;
if (g1> 0) g1--;
if (b1>10) b1--;
setrgbpalette (c,r1,g1,b1);
delay(5);}}